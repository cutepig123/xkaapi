<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Kaapi: Core::NUMAProcessorStealAlgorithm Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespace_core.html">Core</a>::<a class="el" href="class_core_1_1_n_u_m_a_processor_steal_algorithm.html">NUMAProcessorStealAlgorithm</a>
  </div>
</div>
<div class="contents">
<h1>Core::NUMAProcessorStealAlgorithm Class Reference<br/>
<small>
[<a class="el" href="group___core.html">Core</a>]</small>
</h1><!-- doxytag: class="Core::NUMAProcessorStealAlgorithm" --><!-- doxytag: inherits="Core::WakeupFirstProcessorStealAlgorithm,Core::RandomVictim" -->
<p>NUMAStealAlgorithm of a K-Processor1/ if local steal then try to wakeup thread 2/ Steal task from threads 3/ steal the work set.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;kaapi_numa_strategy.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Core::NUMAProcessorStealAlgorithm:</div>
<div class="dynsection">
<div class="center"><img src="class_core_1_1_n_u_m_a_processor_steal_algorithm__inherit__graph.png" border="0" usemap="#_core_1_1_n_u_m_a_processor_steal_algorithm_inherit__map" alt="Inheritance graph"/></div>
<map name="_core_1_1_n_u_m_a_processor_steal_algorithm_inherit__map" id="_core_1_1_n_u_m_a_processor_steal_algorithm_inherit__map">
<area shape="rect" id="node2" href="class_core_1_1_wakeup_first_processor_steal_algorithm.html" title="DefaultStealAlgorithm of a K&#45;Processor1/ if local steal then try to wakeup thread..." alt="" coords="5,160,325,189"/><area shape="rect" id="node4" href="class_core_1_1_processor_steal_algorithm.html" title="StealAlgorithm of a K&#45;ProcessorAn instance of this class is attached to each processor..." alt="" coords="73,83,308,112"/><area shape="rect" id="node6" href="class_core_1_1_steal_algorithm.html" title="Base class to implement an algorithm for work stealingAll objects that inherit from..." alt="" coords="107,5,275,35"/><area shape="rect" id="node8" href="class_core_1_1_select_victim_interface.html" title="Virtual base class for selection of a victim processor." alt="" coords="305,5,524,35"/><area shape="rect" id="node10" href="class_core_1_1_random_victim.html" title="Random work stealing algorithm on a worksetDo random choice of the processor." alt="" coords="349,160,517,189"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Core::NUMAProcessorStealAlgorithm:</div>
<div class="dynsection">
<div class="center"><img src="class_core_1_1_n_u_m_a_processor_steal_algorithm__coll__graph.png" border="0" usemap="#_core_1_1_n_u_m_a_processor_steal_algorithm_coll__map" alt="Collaboration graph"/></div>
<map name="_core_1_1_n_u_m_a_processor_steal_algorithm_coll__map" id="_core_1_1_n_u_m_a_processor_steal_algorithm_coll__map">
<area shape="rect" id="node2" href="class_core_1_1_wakeup_first_processor_steal_algorithm.html" title="DefaultStealAlgorithm of a K&#45;Processor1/ if local steal then try to wakeup thread..." alt="" coords="2233,1675,2553,1704"/><area shape="rect" id="node4" href="class_core_1_1_processor_steal_algorithm.html" title="StealAlgorithm of a K&#45;ProcessorAn instance of this class is attached to each processor..." alt="" coords="1817,1675,2052,1704"/><area shape="rect" id="node6" href="class_core_1_1_steal_algorithm.html" title="Base class to implement an algorithm for work stealingAll objects that inherit from..." alt="" coords="489,1585,657,1615"/><area shape="rect" id="node44" href="class_core_1_1_stealable_with_instance_reification.html" title="Interface for object that accepts steal request with instance reificationInstances..." alt="" coords="957,1468,1253,1497"/><area shape="rect" id="node8" href="class_core_1_1_select_victim_interface.html" title="Virtual base class for selection of a victim processor." alt="" coords="1432,1701,1651,1731"/><area shape="rect" id="node134" href="class_core_1_1_random_victim.html" title="Random work stealing algorithm on a worksetDo random choice of the processor." alt="" coords="1851,1728,2019,1757"/><area shape="rect" id="node10" href="class_core_1_1_processor.html" title="KAAPI ProcessorProcessor manages scheduling of a set of threads with at most one..." alt="" coords="1475,943,1608,972"/><area shape="rect" id="node67" href="class_core_1_1_thread.html" title="Flow of controlA Core::Thread is a flow of control which consist of its runtime environnement..." alt="" coords="1877,1259,1992,1288"/><area shape="rect" id="node93" href="class_core_1_1_work_set.html" title="WorkSet of worksetThe workset is a set of processors with a steal interface to steal..." alt="" coords="1875,737,1995,767"/><area shape="rect" id="node12" href="class_util_1_1_thread.html" title="POSIX interface to thread." alt="" coords="1052,409,1159,439"/><area shape="rect" id="node34" href="class_util_1_1_event_buffer_manager.html" title="A Generic Buffer Manager : EventBufferManager EventBufferManager is an implementation..." alt="" coords="1440,343,1643,372"/><area shape="rect" id="node14" href="class_util_1_1_object_id.html" title="Object with identifierThe Object class defines object that needs to have and identifier..." alt="" coords="516,564,631,593"/><area shape="rect" id="node96" href="class_util_1_1_object.html" title="Object with synchronisation mutex and condition variablesThe Object class defines..." alt="" coords="1492,604,1591,633"/><area shape="rect" id="node17" href="class_util_1_1_key.html" title="Util::Key\&lt; ByteAllocator \&gt;" alt="" coords="472,391,675,420"/><area shape="rect" id="node19" href="class_util_1_1_key.html" title="Thread private attributeThis class provides an interface to posix pthread specific..." alt="" coords="25,444,145,473"/><area shape="rect" id="node21" href="class_util_1_1_key.html" title="Util::Key\&lt; Thread \&gt;" alt="" coords="492,444,655,473"/><area shape="rect" id="node125" href="class_util_1_1_key.html" title="Util::Key\&lt; Processor \&gt;" alt="" coords="755,753,933,783"/><area shape="rect" id="node24" href="class_util_1_1_o_event_stream.html" title="Output events stream: Util::OEventStream." alt="" coords="1856,140,2013,169"/><area shape="rect" id="node26" href="class_util_1_1_context_id.html" title="Util::ContextId" alt="" coords="1044,5,1167,35"/><area shape="rect" id="node28" href="class_util_1_1_event_buffer.html" title="A Generic Trace Buffer class: Util::EventBuffer." alt="" coords="1472,19,1611,48"/><area shape="rect" id="node31" href="class_util_1_1_global_id.html" title="Class for representing a global identifier of the distributed processusGlobal Identifier..." alt="" coords="1049,140,1161,169"/><area shape="rect" id="node37" href="class_util_1_1_condition.html" title="Posix conditionsThis class implements interface to posix condition variable. All..." alt="" coords="1045,665,1165,695"/><area shape="rect" id="node39" href="class_util_1_1_mutex.html" title="Exclusive code execution.This class implements interface for Posix mutex. All errors..." alt="" coords="1056,483,1155,512"/><area shape="rect" id="node42" href="struct_util_1_1kaapi__atomic__t.html" title="Util::kaapi_atomic_t" alt="" coords="5,1339,165,1368"/><area shape="rect" id="node77" href="class_util_1_1_atomic.html" title="Atomic object represents atomic operation over integer.This class implements object..." alt="" coords="1491,1440,1592,1469"/><area shape="rect" id="node111" href="struct_core_1_1___spin_lock.html" title="Core::_SpinLock" alt="" coords="507,1339,640,1368"/><area shape="rect" id="node46" href="class_core_1_1_stealable.html" title="Base interface for object that accepts steal request." alt="" coords="508,1468,639,1497"/><area shape="rect" id="node49" href="class_core_1_1_idleable_with_instance_reification.html" title="Interface for object that allows reification of idle_activity." alt="" coords="961,1021,1249,1051"/><area shape="rect" id="node51" href="class_core_1_1_idleable.html" title="Interface for object that has idle_activity interface..." alt="" coords="512,1049,635,1079"/><area shape="rect" id="node54" href="class_util_1_1_interface_allocator.html" title="Util::InterfaceAllocator" alt="" coords="1015,915,1196,944"/><area shape="rect" id="node56" href="class_util_1_1_interface_deallocator.html" title="Util::InterfaceDeallocator" alt="" coords="1004,968,1207,997"/><area shape="rect" id="node58" href="class_util_1_1_interface_notify.html" title="InterfaceNotify for the local signal." alt="" coords="1024,1232,1187,1261"/><area shape="rect" id="node60" href="class_util_1_1_callback_collect_counters.html" title="Callback function to collect countersThe class defines interface that should overloaded..." alt="" coords="992,1179,1219,1208"/><area shape="rect" id="node62" href="class_util_1_1_linkable.html" title="Util::Linkable\&lt; CallbackCollectCounters \&gt;" alt="" coords="416,1232,731,1261"/><area shape="rect" id="node65" href="class_util_1_1_linkable.html" title="Base class to make cells linkable in single linked listTo be (de)linkable in single..." alt="" coords="9,1453,161,1483"/><area shape="rect" id="node81" href="class_core_1_1_condition.html" title="Condition to signal end of steal operationThis class implements one method for synchronisation..." alt="" coords="2328,1544,2459,1573"/><area shape="rect" id="node115" href="class_core_1_1_thread_queue.html" title="ThreadQueue of threads." alt="" coords="2312,953,2475,983"/><area shape="rect" id="node119" href="class_core_1_1_thread_stack.html" title="ThreadStack of threadsLink using _next field of Core::Thread." alt="" coords="2316,1233,2471,1263"/><area shape="rect" id="node72" href="class_core_1_1_printable.html" title="Core::Printable" alt="" coords="1477,1285,1605,1315"/><area shape="rect" id="node87" href="class_core_1_1_thread_format.html" title="Format for a Thread." alt="" coords="1459,1576,1624,1605"/><area shape="rect" id="node89" href="class_util_1_1_format.html" title="Definition of the format of a data typeA Format is the definition of the format for..." alt="" coords="1052,1597,1159,1627"/><area shape="rect" id="node103" href="class_util_1_1_counters.html" title="Counters generate by each gid and accumulated on the collector processSuch object..." alt="" coords="1047,743,1164,772"/><area shape="rect" id="node109" href="struct_core_1_1_spin_lock.html" title="Core::SpinLock" alt="" coords="1043,1339,1168,1368"/><area shape="rect" id="node130" href="class_util_1_1_byte_allocator.html" title="ByteAllocator of fixed size objects with cache for fast allocation (thread unsafe)A..." alt="" coords="1032,861,1179,891"/><area shape="rect" id="node132" href="class_util_1_1_stack_list.html" title="Util::StackList\&lt; Bloc \&gt;" alt="" coords="485,861,661,891"/><area shape="rect" id="node137" href="class_util_1_1_random_uniform_stdlib.html" title="Util::RandomUniformStdlib" alt="" coords="1437,1755,1645,1784"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_core_1_1_n_u_m_a_processor_steal_algorithm-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_core_1_1_n_u_m_a_processor_steal_algorithm.html#a49e4c4558d002e7664daf89a0edfb545">do_steal</a> (<a class="el" href="class_core_1_1_thread.html">Core::Thread</a> *&amp;victim_thread, <a class="el" href="class_core_1_1_thread.html">Core::Thread</a> *&amp;thief_thread, const ProcessorId &amp;thief_processor, ProcessorId &amp;victim_processor)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>NUMAStealAlgorithm of a K-Processor</p>
<p>1/ if local steal then try to wakeup thread 2/ Steal task from threads 3/ steal the work set. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a49e4c4558d002e7664daf89a0edfb545"></a><!-- doxytag: member="Core::NUMAProcessorStealAlgorithm::do_steal" ref="a49e4c4558d002e7664daf89a0edfb545" args="(Core::Thread *&amp;victim_thread, Core::Thread *&amp;thief_thread, const ProcessorId &amp;thief_processor, ProcessorId &amp;victim_processor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Core::NUMAProcessorStealAlgorithm::do_steal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_core_1_1_thread.html">Core::Thread</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>victim_thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_core_1_1_thread.html">Core::Thread</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>thief_thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ProcessorId &amp;&nbsp;</td>
          <td class="paramname"> <em>thief_processor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ProcessorId &amp;&nbsp;</td>
          <td class="paramname"> <em>victim_processor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Steal work from the current workset. This method should be implemented in derived class to steal work. The work is returned inside the 'thief_thread' <a class="el" href="class_core_1_1_thread.html" title="Flow of controlA Core::Thread is a flow of control which consist of its runtime environnement...">Thread</a> object. The StealContext may be used to recall the history of the steal requests onto this workset. If some work is found to be stolen, then the thread pointed by thief_thread is initialized with the theft work and true is returned. If the thread pointed by thief_thread is 0, then a new thread is created but it is not attached to any workset. If thief_thread is not 0 before calling the method, then thief_thread should be in CREATED, SUSPEND, STOPPED or both state, but it should never be running or terminated else the return value is false.</p>
<p>The current workset SHOULD be locked before calling the method. The caller may specify a pointer to the child object of the workset to avoid exploration of the child during the search of piece of work. If it is not given, the value 0 is used to indicates that all the subtree referenced by the workset 'this' is explored. The default implementation iterates over all sub worksets in round robin fashion from the child pointed by next_child if the StealContext (if given). If the steal context is 0, then the iteration begins from the front of the queue of child workset.</p>
<p>Two cases should be considered on return to the invocation with a return value 'true':</p>
<ul>
<li>victim_thread == thief_thread: it means that the victim becomes the thief, i.e. a suspended thread has been wakeup during the steal operation.</li>
<li>victim_thread != thief_thread: the thief has been build by coping piece of work. In this case the thief_thread may required to be attached to a workset if it is created by the invocation.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>victim_thread</em>&nbsp;</td><td>[out] the thread that is theft </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>thief_thread</em>&nbsp;</td><td>[in,out] the thread that will store theft work, may be 0 in input </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>thief_processor</em>&nbsp;</td><td>[in] the idle processor that initiates the steal request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>victim_processor</em>&nbsp;</td><td>[out] the id of the processor that has been theft in case of successfull request </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>iff the steal operation steals work </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>iff the steal operation fails to steal work </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="class_core_1_1_wakeup_first_processor_steal_algorithm.html#adeb71faa74b08ff43998cc8f209bd0a4">Core::WakeupFirstProcessorStealAlgorithm</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="kaapi__numa__strategy_8h.html">kaapi_numa_strategy.h</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Wed Jun 16 08:52:12 2010 for Kaapi by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
