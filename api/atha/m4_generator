#!/bin/sh
#
## KAAPI library source
## -----------------------------------------
##
## by Thierry Gautier. Based on idea of M. Doreille
## Apache Project, IMAG, Grenoble, France
##
## use:
#  m4_generator <NB_PARAM> 
#


makeheader() {
cat <<ENDDDD 
/* KAAPI/Athapascan public interface */
// KAAPI library source
// -----------------------------------------
// by Thierry Gautier
//(c) INRIA, projet MOAIS, 2006-2010
//
// **********************************************************
// WARNING! This file has been automatically generated by M4
// *********************************************************
ENDDDD

}



#############################################################
## loop for file bodies
#############################################################

NUMBER=0
COUNTER=$1
MAX_NUMBER_PARAMS=$1
## `expr $1 + 1`

makeheader > athapascan_closure.h
makeheader > athapascan_fork.h
while [ $COUNTER -ge 0 ]
do
      m4 -DKAAPI_NUMBER_PARAMS=$NUMBER -DKAAPI_MAX_NUMBER_PARAMS=$MAX_NUMBER_PARAMS m4_macros  athapascan_closure_gen.m4 >> athapascan_closure.h
      if [ $NUMBER -gt 0 ]
      then
        m4 -DKAAPI_NUMBER_PARAMS=$NUMBER -DKAAPI_MAX_NUMBER_PARAMS=$MAX_NUMBER_PARAMS m4_macros  athapascan_fork_gen.m4 >> athapascan_fork.h
      fi
      echo "Generating file: $file step $NUMBER :-)"
      NUMBER=`expr $NUMBER + 1`
      COUNTER=`expr $COUNTER - 1`
done


